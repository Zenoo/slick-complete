class SlickCompleteItem{constructor(id,text,name,icon){this.id=id,this.text=text,this.name=name,this.icon=icon}}class SlickComplete{constructor(target,parameters={icon:!1,lang:"en",items:[]}){if(this._input=target instanceof Element?target:document.querySelector(target),!this._input)throw new Error("SlickComplete: "+("string"==typeof target?"The selector `"+target+"` didn't match any element.":"The element you provided was undefined"));if(this._input.classList.contains("slick-complete-input"))throw new Error("SlickComplete: The element has already been initialized.");this._onSelect=[],this._onPredict=[],this._parameters=parameters,this.value="",void 0===this._parameters.lang&&(this._parameters.lang="en"),void 0===this._parameters.icon&&(this._parameters.icon=!1),this._parameters.items&&(this._parameters.items=this._parameters.items.map(item=>{item.searchTerms=item.aliases.map(s=>s.toLowerCase());for(let lang in item.name)item.searchTerms.push(item.name[lang].toLowerCase());return item})),this._build(),this._listen()}_build(){this._wrapper=document.createElement("div"),this._wrapper.classList.add("slick-complete"),this._input.parentNode.insertBefore(this._wrapper,this._input);let border=document.createElement("div");if(border.classList.add("slick-complete-border"),this._wrapper.appendChild(border),this._parameters.icon){this._wrapper.classList.add("slick-complete-icon-enabled");let iconWrapper=document.createElement("aside");iconWrapper.classList.add("slick-complete-icon"),iconWrapper.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8S12.4 0 8 0zM9.2 13H6.9v-1.9h2.4V13zM11.5 7.3c-0.2 0.2-0.6 0.6-1.2 0.9l-0.6 0.4c-0.3 0.2-0.5 0.4-0.6 0.7 -0.1 0.2-0.1 0.4-0.1 0.8H6.9C7 9.4 7.1 8.9 7.2 8.6c0.1-0.3 0.5-0.6 1.1-1L8.8 7.2l0.5-0.4c0.2-0.2 0.3-0.5 0.3-0.8 0-0.3-0.1-0.6-0.4-0.9 -0.2-0.3-0.7-0.4-1.3-0.4 -0.6 0-1 0.2-1.3 0.5C6.4 5.5 6.3 5.9 6.3 6.2H4c0.1-1.3 0.6-2.2 1.6-2.7C6.2 3.2 7 3 7.9 3c1.2 0 2.2 0.2 3 0.7C11.6 4.2 12 4.9 12 5.9 12 6.5 11.8 6.9 11.5 7.3z" fill="#030104"/></svg>',this._icon=iconWrapper.getElementsByTagName("svg")[0],border.appendChild(iconWrapper)}this._prediction=document.createElement("input"),this._prediction.classList.add("slick-complete-prediction"),border.appendChild(this._prediction),this._input.classList.add("slick-complete-input"),this._input=border.appendChild(this._input),this._validate=document.createElement("aside"),this._validate.classList.add("slick-complete-validate"),this._validate.innerHTML='<svg enable-background="new 0 0 26 26" version="1.1" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="m0.3 14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4 0l0.1 0.1 5.5 5.9c0.2 0.2 0.5 0.2 0.7 0l13.4-13.9h0.1v-8.8818e-16c0.4-0.4 1-0.4 1.4 0l1.4 1.4c0.4 0.4 0.4 1 0 1.4l-16 16.6c-0.2 0.2-0.4 0.3-0.7 0.3s-0.5-0.1-0.7-0.3l-7.8-8.4-0.2-0.3z"/></svg>',border.appendChild(this._validate)}_listen(){this._input.addEventListener("input",()=>{if(this._input.value.length){let closestMatch=this.find(this._input.value);if(closestMatch){closestMatch.text!=closestMatch.name.toLowerCase()?this._prediction.value=closestMatch.text+" ("+closestMatch.name+")":this._prediction.value=closestMatch.text,this._input.value=this._input.value.toLowerCase(),this._prediction.setAttribute("data-item-id",""+closestMatch.id),this._parameters.icon&&(this._icon.innerHTML='<image xlink:href="'+closestMatch.icon+'"/>');for(let prediction of this._onPredict)prediction.call(this,this._input.value,this._parameters.items.find(e=>e.id==closestMatch.id))}else this._prediction.value=this._input.value,this._prediction.setAttribute("data-item-id",""),this._parameters.icon&&(this._icon.innerHTML='<path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8S12.4 0 8 0zM9.2 13H6.9v-1.9h2.4V13zM11.5 7.3c-0.2 0.2-0.6 0.6-1.2 0.9l-0.6 0.4c-0.3 0.2-0.5 0.4-0.6 0.7 -0.1 0.2-0.1 0.4-0.1 0.8H6.9C7 9.4 7.1 8.9 7.2 8.6c0.1-0.3 0.5-0.6 1.1-1L8.8 7.2l0.5-0.4c0.2-0.2 0.3-0.5 0.3-0.8 0-0.3-0.1-0.6-0.4-0.9 -0.2-0.3-0.7-0.4-1.3-0.4 -0.6 0-1 0.2-1.3 0.5C6.4 5.5 6.3 5.9 6.3 6.2H4c0.1-1.3 0.6-2.2 1.6-2.7C6.2 3.2 7 3 7.9 3c1.2 0 2.2 0.2 3 0.7C11.6 4.2 12 4.9 12 5.9 12 6.5 11.8 6.9 11.5 7.3z" fill="#030104"/>')}else this._prediction.value="",this._prediction.setAttribute("data-item-id",""),this._parameters.icon&&(this._icon.innerHTML='<path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8S12.4 0 8 0zM9.2 13H6.9v-1.9h2.4V13zM11.5 7.3c-0.2 0.2-0.6 0.6-1.2 0.9l-0.6 0.4c-0.3 0.2-0.5 0.4-0.6 0.7 -0.1 0.2-0.1 0.4-0.1 0.8H6.9C7 9.4 7.1 8.9 7.2 8.6c0.1-0.3 0.5-0.6 1.1-1L8.8 7.2l0.5-0.4c0.2-0.2 0.3-0.5 0.3-0.8 0-0.3-0.1-0.6-0.4-0.9 -0.2-0.3-0.7-0.4-1.3-0.4 -0.6 0-1 0.2-1.3 0.5C6.4 5.5 6.3 5.9 6.3 6.2H4c0.1-1.3 0.6-2.2 1.6-2.7C6.2 3.2 7 3 7.9 3c1.2 0 2.2 0.2 3 0.7C11.6 4.2 12 4.9 12 5.9 12 6.5 11.8 6.9 11.5 7.3z" fill="#030104"/>')});const validateItem=()=>{if(this._prediction.getAttribute("data-item-id").length){this._input.value=this._prediction.value,this._input.blur(),this.value=this._prediction.getAttribute("data-item-id");for(let selection of this._onSelect)selection.call(this,this._parameters.items.find(e=>e.id==this._prediction.getAttribute("data-item-id")))}};this._input.addEventListener("keyup",e=>{13!=e.which&&13!=e.keyCode||validateItem()}),this._validate.addEventListener("click",()=>{validateItem()}),this._input.addEventListener("focus",()=>{this._wrapper.classList.add("focused")}),this._input.addEventListener("blur",()=>{this._wrapper.classList.remove("focused")})}find(value){let search=value.toLowerCase();if(!this._parameters.items)throw new Error("SlickComplete: There are no items to search through. Add some with the `items` property of the options parameter or with the `setItems` method");let matchingItem=this._parameters.items.filter(e=>e.searchTerms.some(s=>s.startsWith(search)))[0];return matchingItem?new SlickCompleteItem(matchingItem.id,matchingItem.searchTerms.filter(s=>s.startsWith(search))[0],matchingItem.name[this._parameters.lang],matchingItem.icon):null}onSelect(callback){return this._onSelect.push(callback),this}offSelect(){return this._onSelect=[],this}onPredict(callback){return this._onPredict.push(callback),this}offPredict(){return this._onPredict=[],this}refresh(){let event=new CustomEvent("input");return this._input.dispatchEvent(event),this}select(itemId){let item=this._parameters.items.find(e=>e.id==itemId);this._prediction.value=item.name[this._parameters.lang],this._input.value=item.name[this._parameters.lang],this._prediction.setAttribute("data-item-id",item.id),this._parameters.icon&&(this._icon.innerHTML='<image xlink:href="'+item.icon+'"/>'),this._input.blur();for(let selection of this._onSelect)selection.call(this,item);return this}setItems(items){return this._parameters.items=items.map(item=>{item.searchTerms=item.aliases.map(s=>s.toLowerCase());for(let lang in item.name)item.searchTerms.push(item.name[lang].toLowerCase());return item}),this}destroy(){this._wrapper.parentNode.insertBefore(this._input,this._wrapper),this._wrapper.remove(),this._input.classList.remove("slick-complete-input");for(let prop in this)this[prop]=null}}